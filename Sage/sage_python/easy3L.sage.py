

# This file was *autogenerated* from the file easy3L.sage
from sage.all_cmdline import *   # import sage library

_sage_const_25886434964719448194352673440525701654705794467884891063997131230558866479588298264578120588832128279435501897537203249743883076992668855905005985050222145380285378634993563571078034923112985724204131887907198503097115380966366598622251191576354831935118147880783949022370177789175320661630501595157946150891275992785113199863734714343650596491139321990230671901990010723398037081693145723605154355325074739107535905777351 = Integer(25886434964719448194352673440525701654705794467884891063997131230558866479588298264578120588832128279435501897537203249743883076992668855905005985050222145380285378634993563571078034923112985724204131887907198503097115380966366598622251191576354831935118147880783949022370177789175320661630501595157946150891275992785113199863734714343650596491139321990230671901990010723398037081693145723605154355325074739107535905777351); _sage_const_2332673914418001018316159191702497430320194762477685969994411366563846498561222483921873160125818295447435796015251682805613716554577537183122368080760105458908517619529332931042168173262127728892648742025494771751133664547888267249802368767396121189473647263861691578834674578112521646941677994097088669110583465311980605508259404858000937372665500663077299603396786862387710064061811000146453852819607311367850587534711 = Integer(2332673914418001018316159191702497430320194762477685969994411366563846498561222483921873160125818295447435796015251682805613716554577537183122368080760105458908517619529332931042168173262127728892648742025494771751133664547888267249802368767396121189473647263861691578834674578112521646941677994097088669110583465311980605508259404858000937372665500663077299603396786862387710064061811000146453852819607311367850587534711); _sage_const_20329058681057003355767546524327270876901063126285410163862577312957425318547938475645814390088863577141554443432653658287774537679738768993301095388221262144278253212238975358868925761055407920504398004143126310247822585095611305912801250788531962681592054588938446210412897150782558115114462054815460318533279921722893020563472010279486838372516063331845966834180751724227249589463408168677246991839581459878242111459287 = Integer(20329058681057003355767546524327270876901063126285410163862577312957425318547938475645814390088863577141554443432653658287774537679738768993301095388221262144278253212238975358868925761055407920504398004143126310247822585095611305912801250788531962681592054588938446210412897150782558115114462054815460318533279921722893020563472010279486838372516063331845966834180751724227249589463408168677246991839581459878242111459287); _sage_const_2 = Integer(2); _sage_const_512 = Integer(512); _sage_const_0 = Integer(0); _sage_const_1 = Integer(1); _sage_const_28572152986082018877402362001567466234043851789360735202177142484311397443337910028526704343260845684960897697228636991096551426116049875141 = Integer(28572152986082018877402362001567466234043851789360735202177142484311397443337910028526704343260845684960897697228636991096551426116049875141); _sage_const_1267231041216362976881495706209012999926322160351147349200659893781191687605978675590209327810284956626443266982499935032073788984220619657447889609681888 = Integer(1267231041216362976881495706209012999926322160351147349200659893781191687605978675590209327810284956626443266982499935032073788984220619657447889609681888); _sage_const_9739918644806242673966205531575183334306589742344399829232076845951304871478438938119813187502023845332528267974698273405630514228632721928260463654612997 = Integer(9739918644806242673966205531575183334306589742344399829232076845951304871478438938119813187502023845332528267974698273405630514228632721928260463654612997); _sage_const_9755668823764800147393276745829186812540710004256163127825800861195296361046987938775181398489372822667854079119037446327498475937494635853074634666112736 = Integer(9755668823764800147393276745829186812540710004256163127825800861195296361046987938775181398489372822667854079119037446327498475937494635853074634666112736); _sage_const_3 = Integer(3); _sage_const_4 = Integer(4); _sage_const_6 = Integer(6)
from Crypto.Util.number import *
from functools import reduce
from gmpy2 import *


# arg we known
p = _sage_const_25886434964719448194352673440525701654705794467884891063997131230558866479588298264578120588832128279435501897537203249743883076992668855905005985050222145380285378634993563571078034923112985724204131887907198503097115380966366598622251191576354831935118147880783949022370177789175320661630501595157946150891275992785113199863734714343650596491139321990230671901990010723398037081693145723605154355325074739107535905777351 
h = _sage_const_2332673914418001018316159191702497430320194762477685969994411366563846498561222483921873160125818295447435796015251682805613716554577537183122368080760105458908517619529332931042168173262127728892648742025494771751133664547888267249802368767396121189473647263861691578834674578112521646941677994097088669110583465311980605508259404858000937372665500663077299603396786862387710064061811000146453852819607311367850587534711 
c = _sage_const_20329058681057003355767546524327270876901063126285410163862577312957425318547938475645814390088863577141554443432653658287774537679738768993301095388221262144278253212238975358868925761055407920504398004143126310247822585095611305912801250788531962681592054588938446210412897150782558115114462054815460318533279921722893020563472010279486838372516063331845966834180751724227249589463408168677246991839581459878242111459287 

# get s[3]
"""
a = 25886434964719448194352673440525701654705794467884891063997131230558866479588298264578120588832128279435501897537203249743883076992668855905005985050222145380285378634993563571078034923112985724204131887907198503097115380966366598622251191576354831935118147880783949022370177789175320661630501595157946150891275992785113199863734714343650596491139321990230671901990010723398037081693145723605154355325074739107535905777351
print(a.nbits())
"""
M = Matrix([[_sage_const_2 **_sage_const_512 , _sage_const_0 , c], [_sage_const_0 , _sage_const_1 , -h], [_sage_const_0 , _sage_const_0 , p]])
#print(M.LLL())
M = M.LLL()[_sage_const_0 ]

# get flag
S3 = abs(M[-_sage_const_1 ])
S1 = _sage_const_28572152986082018877402362001567466234043851789360735202177142484311397443337910028526704343260845684960897697228636991096551426116049875141 
S2 = _sage_const_1267231041216362976881495706209012999926322160351147349200659893781191687605978675590209327810284956626443266982499935032073788984220619657447889609681888 
S4 = _sage_const_9739918644806242673966205531575183334306589742344399829232076845951304871478438938119813187502023845332528267974698273405630514228632721928260463654612997 
S5 = _sage_const_9755668823764800147393276745829186812540710004256163127825800861195296361046987938775181398489372822667854079119037446327498475937494635853074634666112736 
S = [S1, S2, S3, S4, S5]
T = [s1 - s0 for s0, s1 in zip(S, S[_sage_const_1 :])]
p = [t2*t0 - t1*t1 for t0, t1, t2 in zip(T, T[_sage_const_1 :], T[_sage_const_2 :])]
p = int(abs(reduce(gcd, p)))
#print(m)
A = Matrix([[S[_sage_const_0 ], S[_sage_const_1 ], _sage_const_1 /p, _sage_const_0 , _sage_const_0 ], [_sage_const_1 , _sage_const_1 , _sage_const_0 , _sage_const_1 /p, _sage_const_0 ], [-S[_sage_const_1 ], -S[_sage_const_2 ], _sage_const_0 , _sage_const_0 , _sage_const_1 ], [p, _sage_const_0 , _sage_const_0 , _sage_const_0 , _sage_const_0 ], [_sage_const_0 , p, _sage_const_0 , _sage_const_0 , _sage_const_0 ]])
#print(A)
A = A.LLL()
a = _sage_const_0 
b = _sage_const_0 
for i in A:
    if i[_sage_const_0 ] == _sage_const_0  and i[_sage_const_1 ] == _sage_const_0 :
        if i[-_sage_const_1 ] == _sage_const_1 :
            a, b = i[_sage_const_2 ] * p, i[_sage_const_3 ] * p
        elif i[-_sage_const_1 ] == -_sage_const_1 :
            a, b = -i[_sage_const_2 ] * p, -i[_sage_const_3 ] * p
        else:
            continue
if _sage_const_0  in (a, b):
    raise ValueError("[*] No solves")
a %= p
b %= p
a1 = invert(a, p)
f = long_to_bytes((a1*(S[_sage_const_0 ]-b)) % p)
if f[:_sage_const_4 ] == b'flag' or f[:_sage_const_6 ] == b'DASCTF':
    print(f)

