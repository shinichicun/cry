

# This file was *autogenerated* from the file solve.sage
from sage.all_cmdline import *   # import sage library

_sage_const_2 = Integer(2); _sage_const_138681122158674534796479818810828100269024674330030901179877002756402543027343312824423418859769980312713625658733 = Integer(138681122158674534796479818810828100269024674330030901179877002756402543027343312824423418859769980312713625658733); _sage_const_4989541340743108588577899263469059346332852532421276369038720203527706762720292559751463880310075002363945271507040 = Integer(4989541340743108588577899263469059346332852532421276369038720203527706762720292559751463880310075002363945271507040); _sage_const_762981334990685089884160169295988791471426441106522959345412318178660817286272606245181160960267776171409174142433857335352402619564485470678152764621235882232914864951345067231483720755544188962798600739631026707678945887174897543 = Integer(762981334990685089884160169295988791471426441106522959345412318178660817286272606245181160960267776171409174142433857335352402619564485470678152764621235882232914864951345067231483720755544188962798600739631026707678945887174897543); _sage_const_19591102741441427006422487362547101973286873135330241799412389205281057650306427438686318050682578531286702107543065985988634367524715153650482199099194389191525898366546842016339136884277515665890331906261550080128989942048438965 = Integer(19591102741441427006422487362547101973286873135330241799412389205281057650306427438686318050682578531286702107543065985988634367524715153650482199099194389191525898366546842016339136884277515665890331906261550080128989942048438965); _sage_const_728465071542637655949094554469510039681717865811604984652385614821789556549826602178972137405550902004858456181137844771163710123158955524137202319902378503104952106036911634918189377295743976966073577013775200078470659428344462772 = Integer(728465071542637655949094554469510039681717865811604984652385614821789556549826602178972137405550902004858456181137844771163710123158955524137202319902378503104952106036911634918189377295743976966073577013775200078470659428344462772); _sage_const_762981334990685089884160169295988791471426441106522959345445792076415993922016249232021560266153453470937452118572318136597282436269660557904217923887981072203978473274822142705255987334355747997513083011853917049784914749699536828 = Integer(762981334990685089884160169295988791471426441106522959345445792076415993922016249232021560266153453470937452118572318136597282436269660557904217923887981072203978473274822142705255987334355747997513083011853917049784914749699536828); _sage_const_3 = Integer(3); _sage_const_13 = Integer(13); _sage_const_199 = Integer(199); _sage_const_307 = Integer(307); _sage_const_647 = Integer(647); _sage_const_157259 = Integer(157259); _sage_const_297617 = Integer(297617); _sage_const_8452217 = Integer(8452217); _sage_const_411927661365999433 = Integer(411927661365999433); _sage_const_1157516701716180046249 = Integer(1157516701716180046249); _sage_const_1338688620929080207819 = Integer(1338688620929080207819); _sage_const_31226697952255326809332037614333 = Integer(31226697952255326809332037614333); _sage_const_581208663471376553417319728009366348095695079579751839149645355600351572890241761173016580183555305805091712621 = Integer(581208663471376553417319728009366348095695079579751839149645355600351572890241761173016580183555305805091712621)
from Crypto.Util.number import *

e = _sage_const_2 
a,b,n,C,leak = [_sage_const_138681122158674534796479818810828100269024674330030901179877002756402543027343312824423418859769980312713625658733 , _sage_const_4989541340743108588577899263469059346332852532421276369038720203527706762720292559751463880310075002363945271507040 , _sage_const_762981334990685089884160169295988791471426441106522959345412318178660817286272606245181160960267776171409174142433857335352402619564485470678152764621235882232914864951345067231483720755544188962798600739631026707678945887174897543 , (_sage_const_19591102741441427006422487362547101973286873135330241799412389205281057650306427438686318050682578531286702107543065985988634367524715153650482199099194389191525898366546842016339136884277515665890331906261550080128989942048438965 , _sage_const_728465071542637655949094554469510039681717865811604984652385614821789556549826602178972137405550902004858456181137844771163710123158955524137202319902378503104952106036911634918189377295743976966073577013775200078470659428344462772 ), _sage_const_762981334990685089884160169295988791471426441106522959345445792076415993922016249232021560266153453470937452118572318136597282436269660557904217923887981072203978473274822142705255987334355747997513083011853917049784914749699536828 ]
E = EllipticCurve(Zmod(n),[a,b])
C = E(C)

#factordb
#2^2,3^4,13,199,307,647,157259,297617,8452217,411927661365999433,1157516701716180046249,1338688620929080207819,31226697952255326809332037614333,581208663471376553417319728009366348095695079579751839149645355600351572890241761173016580183555305805091712621
leak_fac = [_sage_const_2 ,_sage_const_3 ,_sage_const_13 ,_sage_const_199 ,_sage_const_307 ,_sage_const_647 ,_sage_const_157259 ,_sage_const_297617 ,_sage_const_8452217 ,_sage_const_411927661365999433 ,_sage_const_1157516701716180046249 ,_sage_const_1338688620929080207819 ,_sage_const_31226697952255326809332037614333 ,_sage_const_581208663471376553417319728009366348095695079579751839149645355600351572890241761173016580183555305805091712621 ]


for i in leak_fac:
    temp = leak // i * C

"""kp = 422522588482185975632147929645103216180089543839772868484032620301855259044079430236142637458472152787337779544279109415705783248825091269039840404202119229567311048216047356951966653331710686649176005328509793328313264251738045723
p = GCD(kp,n)
q = n//p

Ep = EllipticCurve(Zmod(p), [a, b])
Eq = EllipticCurve(Zmod(q), [a, b])
ord_p = Ep.order()
ord_q = Eq.order()
#print(ord_p)
#print(ord_q)

dq = inverse(e,ord_q)
Q = dq*Eq(C)
mq = int(Q[0])

#print(Ep(C))
PR.<x> = PolynomialRing(GF(p))
f = (3*(x**2)+a)**2 - 2*x*(4*(x**3+a*x+b)) - int(C[0])*4*(x**3+a*x+b)
res = f.roots()
#print(res)

n = [p,q]
if(res):
    for i in res:
        c = [int(i[0]),mq]
        m = crt(c,n)
        print(long_to_bytes(m))"""

